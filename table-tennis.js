!function(t){var e={};function i(s){if(e[s])return e[s].exports;var a=e[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";var s,a;i.r(e),function(t){t[t.Up=38]="Up",t[t.Down=40]="Down",t[t.KeyW=87]="KeyW",t[t.KeyS=83]="KeyS"}(s||(s={}));class n{constructor(){this._keysHandled=[s.Up,s.Down,s.KeyW,s.KeyS],this._keysPressed={}}setup(){document.addEventListener("keydown",this._onKeyPress.bind(this),!1),document.addEventListener("keyup",this._onKeyPress.bind(this),!1)}getPlayerInput(){return{player1:{up:!!this._keysPressed[s.Up],down:!!this._keysPressed[s.Down]},player2:{up:!!this._keysPressed[s.KeyW],down:!!this._keysPressed[s.KeyS]}}}_onKeyPress(t){this._keysHandled.includes(t.keyCode)&&(t.preventDefault(),this._keysPressed[t.keyCode]="keydown"===t.type)}}class r{constructor(){this._frames=[]}tick(t){for(;this._frames.length>0&&this._frames[0]<=t-1e3;)this._frames.shift();this._frames.push(t)}getFPS(){return this._frames.length}}class h{constructor(t){this._start=0,this._total=0,this._count=0,this._mean=0,this._min=0,this._max=0,this._name="",this._name=t}start(){this._start=performance.now()}pause(){const t=performance.now()-this._start;this._count+=1,this._total+=t,this._mean=this._mean+(t-this._mean)/this._count,this._min=Math.min(this._min,t),this._max=Math.max(this._max,t),this._start=0}logStats(){console.table({name:this._name,total:`${this._total}ms`,count:this._count,mean:`${this._mean}ms`,min:`${this._min}ms`,max:`${this._max}ms`})}}!function(t){t.Rectangle="rectangle",t.Circle="circle"}(a||(a={}));class o{constructor(t){this._inputManager=new n,this._frameRateTracker=new r,this._canvas=t;const e=this._canvas.getContext("2d");if(!e)throw new Error("Could not get 2D context from provided canvas");this._context=e,this._frameSize={width:this._canvas.width,height:this._canvas.height},this._inputManager.setup(),this._ballRadius=Math.round(this._frameSize.height/72),this._paddleSize={width:Math.round(this._frameSize.width/64),height:Math.round(this._frameSize.height/8)},this._gameState={player1:{pixelsPerSecond:this._frameSize.height,origin:{x:Math.round(this._frameSize.width/64),y:Math.round(this._frameSize.height/2)-this._paddleSize.height/2}},player2:{pixelsPerSecond:this._frameSize.height/2,origin:{x:this._frameSize.width-Math.round(this._frameSize.width/64)-this._paddleSize.width,y:Math.round(this._frameSize.height/2)-this._paddleSize.height/2}},ball:{origin:{x:Math.round(this._frameSize.width/2),y:Math.round(this._frameSize.height/2)},velocity:{x:this._frameSize.width/4,y:this._frameSize.width/4}}}}startGame(){let t=performance.now(),e=0,i=new h("input"),s=new h("update"),n=new h("render");const r=h=>{const o=(h-t)/1e3;e+=1,t=h,this._frameRateTracker.tick(h),i.start();const l=this._inputManager.getPlayerInput();i.pause(),s.start(),this._gameState.player1.origin=this._movePlayer(this._gameState.player1.origin,l.player1,this._gameState.player1.pixelsPerSecond,o),this._gameState.player2.origin=this._movePlayer(this._gameState.player2.origin,l.player2,this._gameState.player2.pixelsPerSecond,o),this._gameState.ball=this._moveBall(this._gameState.ball.origin,this._gameState.ball.velocity,o),s.pause(),n.start(),this._render({entities:[{shape:a.Rectangle,origin:this._gameState.player1.origin,width:this._paddleSize.width,height:this._paddleSize.height},{shape:a.Rectangle,origin:this._gameState.player2.origin,width:this._paddleSize.width,height:this._paddleSize.height},{shape:a.Circle,origin:this._gameState.ball.origin,radius:this._ballRadius}],debug:{fps:this._frameRateTracker.getFPS(),delta:o}}),n.pause(),e%1800==0&&(i.logStats(),s.logStats(),n.logStats()),this._nextTickID=window.requestAnimationFrame(r)};r(performance.now())}stopGame(){void 0!==this._nextTickID&&window.cancelAnimationFrame(this._nextTickID)}_movePlayer(t,e,i,s){let a=0;return e.up&&!e.down?a=-i:!e.up&&e.down&&(a=i),{x:t.x,y:Math.min(Math.max(t.y+a*s,0),this._frameSize.height-this._paddleSize.height)}}_moveBall(t,e,i){let s;return(s={x:t.x+e.x*i,y:t.y+e.y*i}).x<this._ballRadius?(e.x=-1*e.x,s.x=1+e.x*i):s.x>this._frameSize.width-this._ballRadius&&(e.x=-1*e.x,s.x=this._frameSize.width-this._ballRadius+e.x*i),s.y<this._ballRadius?(e.y=-1*e.y,s.y=this._ballRadius+e.y*i):s.y>this._frameSize.height-this._ballRadius&&(e.y=-1*e.y,s.y=this._frameSize.height-this._ballRadius+e.y*i),{origin:s,velocity:e}}_render(t){this._context.clearRect(0,0,this._frameSize.width,this._frameSize.height),this._context.fillStyle="rgb(200, 100, 0)",t.entities.forEach(t=>{t.shape===a.Rectangle?this._context.fillRect(t.origin.x,t.origin.y,t.width,t.height):t.shape===a.Circle&&(this._context.beginPath(),this._context.arc(t.origin.x,t.origin.y,t.radius,0,2*Math.PI,!0),this._context.fill())}),t.debug&&(this._context.fillText(`FPS: ${t.debug.fps||"n/a"}`,30,30),this._context.fillText(`Î”: ${Number(t.debug.delta).toPrecision(3)||"n/a"}`,30,40))}}document.body.onload=function(){const t=document.getElementById("fullscreenBtn"),e=document.getElementById("canvas");if(!e)throw new Error("Could not get canvas");t&&(t.onclick=(()=>{e.requestFullscreen()})),new o(e).startGame()}}]);